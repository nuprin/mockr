<div class="module<%= ' commenting' if flash[:notice] %>">
  <p class="instructions">
    <%= link_to_function "Add general feedback", "mockr.startCommenting()" %> 
    or drag a section on the screen.
  </p>
  <% if flash[:notice] %>
    <div id="notice"><%= flash[:notice] %></div>
  <% end %>
  <% form_for :comment, @comment, :url => comments_url,
              :html => {:id => 'add_feedback_form'} do |f| %>
    <%= f.hidden_field :mock_id, :value => @mock.id %>
    <%= f.hidden_field :x %>
    <%= f.hidden_field :y %>
    <%= f.hidden_field :width %>
    <%= f.hidden_field :height %>
    <%= f.text_area :text %>
    <div>
      <ul class="clearfix" id="feelings_input_fields">
        <% Feeling.find(:all).each do |feeling| %>
          <li>
            <label for="comment_feeling_id_<%= feeling.id %>"
              title="I am <%= feeling.name %>">
              <%= image_tag feeling.path %>
            </label>
            <%= f.radio_button :feeling_id, feeling.id %>
          </li>
        <% end %>
        <% if viewer.real? %>
          <%= f.hidden_field :author_id, :value => session[:user_id] %>
        <% else %>
          <select id="comment_author_id" name="comment[author_id]">
            <option>I am...</option>
            <% User.find(:all).sort_by(&:name).each do |user| %>
              <option value="<%= user.id %>"><%= user.name %></option>
            <% end %>
          </select>
        <% end %>
      </ul>
      <%= image_submit_tag("buttons/add_feedback.gif") %>
    </div>
  <% end %>
</div>